<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css">ol{margin:0;padding:0}table td,table th{padding:0}.c2{-webkit-text-decoration-skip:none;color:#000000;font-weight:400;text-decoration:underline;vertical-align:baseline;text-decoration-skip-ink:none;font-size:12pt;font-family:"Times New Roman";font-style:normal}.c3{-webkit-text-decoration-skip:none;color:#000000;font-weight:700;text-decoration:underline;vertical-align:baseline;text-decoration-skip-ink:none;font-size:12pt;font-family:"Times New Roman";font-style:normal}.c1{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:12pt;font-family:"Times New Roman";font-style:normal}.c4{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:left;height:11pt}.c8{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c0{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:center}.c10{color:#000000;text-decoration:none;vertical-align:baseline;font-style:normal}.c9{font-size:13pt;font-family:"Times New Roman";font-weight:700}.c6{-webkit-text-decoration-skip:none;text-decoration:underline;text-decoration-skip-ink:none}.c5{font-size:12pt;font-family:"Times New Roman";font-weight:400}.c11{font-weight:400;font-size:13pt;font-family:"Times New Roman"}.c12{font-size:16pt;font-family:"Times New Roman";font-weight:700}.c13{background-color:#ffffff;max-width:468pt;padding:72pt 72pt 72pt 72pt}.c7{height:11pt}.title{padding-top:0pt;color:#000000;font-size:26pt;padding-bottom:3pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.subtitle{padding-top:0pt;color:#666666;font-size:15pt;padding-bottom:16pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}li{color:#000000;font-size:11pt;font-family:"Arial"}p{margin:0;color:#000000;font-size:11pt;font-family:"Arial"}h1{padding-top:20pt;color:#000000;font-size:20pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h2{padding-top:18pt;color:#000000;font-size:16pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h3{padding-top:16pt;color:#434343;font-size:14pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h4{padding-top:14pt;color:#666666;font-size:12pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h5{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h6{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}</style></head><body class="c13 doc-content"><p class="c0"><span class="c12">CS184 HW3: Pathtracer</span></p><p class="c0"><span class="c9">Overview</span></p><p class="c8"><span class="c5">In this assignment, we are asked to implement a path tracer. First, we implement functions which generate rays which shoot out of the camera in the scene, then send those rays in random directions within pixels of an image in order to generate lighting for those pixels. Then, we drastically improve the runtime of our ray tracing by implementing BVH acceleration, a technique where you build the bounding boxes of a group of primitives in the scene in order to lessen the amount of objects our rays have to check intersection with. After that, we implement direct lighting which renders an image with the 0th and 1st bounce of light in a scene using two different techniques, direct hemisphere and importance sampling. To expand on this, we then implement indirect lighting, which incorporates the bounces of light past the 1st bounce. Finally, in order to make another runtime optimization, we implement adaptive sampling, which ends sampling rays for a pixel early if the pixel value converges early.</span><hr style="page-break-before:always;display:none;"></p><p class="c0"><span class="c9 c10">Part 1: Ray Generation and Scene Intersection</span></p><p class="c0 c7"><span class="c10 c11"></span></p><p class="c8"><span class="c1">The camera ray generation function takes a position in normalized image space, converts it to camera space, and subsequently a ray in world space originating from the camera. The input is converted to camera space by scaling the dimensions of camera space that is occupied by the whole of normalized image space (w/ absolute values of dimension lengths) and then translating as needed in order to account for points on the negative side of each axis in camera space. This position is then multiplied by the camera-to-world matrix in order to convert it to world space. The unit version of the resulting vector is the direction of the ray and the ray originates from the position of the camera. Near and far clipping planes are also set on ray.min_t and ray.max_t respectively in order to account for areas which the camera should not be able to see. </span></p><p class="c4"><span class="c1"></span></p><p class="c8"><span class="c1">This camera ray generation function is then used by raytrace_pixel(), which takes in the coordinate of a pixel, and randomly samples rays originating from that pixel. The random sampling specifically samples for random decimal x and y values contained WITHIN that pixel in order to encapsulate more ways in which the ray from the camera could go through that pixel (rather than just exactly in the bottom left corner of the target pixel). These rays are traced through the scene in order to return the calculated color of the pixel. All of these samples are averaged at the end to give the final color value of the pixel.</span></p><p class="c4"><span class="c1"></span></p><p class="c8"><span class="c1">In order to handle intersection of rays with triangles, I use the Moller Trumbore Algorithm:</span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 276.50px; height: 182.43px;"><img alt="" src="images/image44.png" style="width: 276.50px; height: 182.43px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c8"><span class="c1">Essentially, this algorithm calculates the time at which the ray hits the triangle as well as the barycentric coordinates describing where the hit point is in an efficient manner. If every barycentric coordinate is between 0 and 1 and the time is between the range given by ray.min_t and ray.max_t, then this ray intersects the triangle. Otherwise, it does not. This function also has to fill out an intersection object if an intersection happens. It sets r.max_t to the t calculated here to reflect that the ray is blocked by this triangle. The intersection object has its t set to the calculated t, its primitive set to the triangle, its bsdf set to the bsdf of the triangle, and its normal set to the normals of the corners of the triangles weighted by their barycentric coordinates.</span></p><p class="c4"><span class="c1"></span></p><p class="c4"><span class="c10 c11"></span></p><p class="c8"><span class="c1">In order to handle intersection of rays with spheres, I first calculate the values on the left of this image:</span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 535.50px; height: 193.09px;"><img alt="" src="images/image42.png" style="width: 535.50px; height: 193.09px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c8"><span class="c1">Here, d is the direction vector of the ray, o is the origin of the ray, c is the center of the sphere, and R is the radius of the sphere. We can then calculate the determinant (the part in the square root of the quadratic formula). If the determinant is negative, then there are no intersections. If the determinant is zero, then there is exactly one intersection. If the determinant is positive, then there are two intersections. The t values can then be calculated with the full quadratic formula. Whenever there are two intersections, the correct t value is the one which is smaller since the ray hits that spot first. If this t value is between ray.min_t and r.max_t, then the intersection is valid. The intersection object is set essentially the same as the triangle except the normal is calculated by taking the position at which the ray intersects the sphere subtracted by the center of the sphere. </span></p><hr style="page-break-before:always;display:none;"><p class="c4"><span class="c1"></span></p><p class="c0"><span class="c6 c5">Banana</span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 480.00px; height: 360.00px;"><img alt="" src="images/image52.png" style="width: 480.00px; height: 360.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c6 c5">Empty</span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 480.00px; height: 360.00px;"><img alt="" src="images/image23.png" style="width: 480.00px; height: 360.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><hr style="page-break-before:always;display:none;"></p><p class="c0"><span class="c6 c5">Gems</span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 480.00px; height: 360.00px;"><img alt="" src="images/image3.png" style="width: 480.00px; height: 360.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c6 c5">Spheres</span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 480.00px; height: 360.00px;"><img alt="" src="images/image4.png" style="width: 480.00px; height: 360.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><hr style="page-break-before:always;display:none;"><p class="c4"><span class="c10 c9"></span></p><p class="c0"><span class="c9">Part 2: Bounding Volume Hierarchy</span></p><p class="c0 c7"><span class="c1"></span></p><p class="c8"><span class="c1">My BVH construction algorithm is a recursive algorithm that takes in the start of a list of primitives, the end of that list of primitives, and the maximum leaf size. First, for every case, it builds the bbox of the current node by adding all the primitives input into it. The base case is when the amount of primitives in the input list is less than or equal to the max leaf size, in which case we are at a leaf node. The only thing done here is assigning the start and end parameters in the node to the start and end parameters given as input, then returning the node. If this condition is not satisfied, then figure out the split axis by picking the axis with the longest distance between the minimum and maximum corners of the bounding box. I then calculate the midpoint of this axis, which is what I use as my split point. I partition the input list into two splits, one where the split axis coordinate of the primitives are less than or equal to the midpoint (left split) and one where that coordinate is greater than the midpoint (right split). I then call this function again on the left split to place into node.l and call it on the right split to place into node.r. There is a special case in which one split has all of the primitives, in which I just sort the input list and set the split point to be the middle of the list, giving half of the primitives to each side. </span></p><p class="c4"><span class="c1"></span></p><p class="c8"><span class="c5">Without BVH acceleration, it takes 38.2499 seconds for peter.dae, 28.2788 seconds for CBbunny.dae, 48.6371s for maxplanck.dae, and 60.8313 seconds for beast.dae. With BVH acceleration, it takes .0179 seconds for peter.dae, .0180 seconds for CBbunny.dae, .0228 seconds for maxplanck.dae, and .0140 seconds for beast.dae. The improvement for BVH acceleration is easily seen. It turns 30 second to minute long render times into less than 1 second render times. While a minute long render time is not too long, these dae files are not that big. If you do not implement BVH acceleration, the runtime will be unfeasible for a large model such as wall-e.dae. So, BVH acceleration is necessary if you want a ray tracing implementation which can actually render in an efficient amount of time. </span><hr style="page-break-before:always;display:none;"></p><p class="c0"><span class="c6 c5">Blob</span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 480.00px; height: 360.00px;"><img alt="" src="images/image51.png" style="width: 480.00px; height: 360.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c6 c5">Lucy</span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 480.00px; height: 360.00px;"><img alt="" src="images/image22.png" style="width: 480.00px; height: 360.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><hr style="page-break-before:always;display:none;"></p><p class="c0"><span class="c6 c5">Max Planck</span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 480.00px; height: 360.00px;"><img alt="" src="images/image33.png" style="width: 480.00px; height: 360.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c6 c5">Wall-E</span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 480.00px; height: 360.00px;"><img alt="" src="images/image53.png" style="width: 480.00px; height: 360.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><hr style="page-break-before:always;display:none;"></p><p class="c0"><span class="c9">Part 3: Direct Illumination</span></p><p class="c4"><span class="c1"></span></p><p class="c8"><span class="c1">First, I will explain the reflectance equation, which is essential for part 3 and part 4: </span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 567.61px; height: 115.00px;"><img alt="" src="images/image12.png" style="width: 567.61px; height: 115.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c8"><span class="c1">The function f_r is the emission of the bsdf going from the ray going into the primitive with this bsdf (w_j) reflecting off of the primitive into the next surface (w_r). Note that since we trace rays which start from the camera, we are actually going into the reverse path of the light as it bounces around the scene, so w_r is the ray which is the input to our lighting functions and w_j is randomly chosen. L_i is the light reflected toward our current primitive from whatever source of light w_j came from. The angle is the angle between the incoming ray w_j and the normal of the primitive. The denominator is the probability that w_j was sampled. The N refers to the number of samples, as you need to take many samples in order to lower the variance of choosing random rays w_j. </span></p><p class="c4"><span class="c1"></span></p><p class="c8"><span class="c1">For direct illumination using direct hemisphere sampling, a ray is made in a random direction from a hemisphere with origin coming from the hit point of an object which our ray shot from the camera hit. If this random ray hits an object, then some light is reflected from that object back to our hit point (as we are actually following the inverse path of the light ray from the light source). We can calculate this contribution by using the reflectance equation. In this reflectance equation, L_i is the emittance from the bsdf of the object the random ray intersects with and the probability is 1 / 2pi since we sampled from a hemisphere uniformly. Otherwise, if the ray does not intersect an object, then that ray contributes nothing to the light level. This is done for multiple samples in order to filter out the randomness from using random rays and then averaged in order to get the final lighting value.</span></p><p class="c4"><span class="c1"></span></p><p class="c8"><span class="c5">For direct illumination using importance sampling, a ray is instead made from the hit point of our object towards a specific light source. If this random ray does not have an object blocking its path toward this light (including the object that its origin is from), then this light contributes towards the lighting of this object which can be calculated through the reflectance equation. In this equation, L_i is the emission of current light and the probability of choosing w_j is defined by a probability density function dependent on the light source. For each light, this is done for many samples and then averaged (per light source, not over all light sources) in order to find the contribution of that light to the color at the hit point. There is a special case for point lights as they always output the same lighting value and can thus just be sampled once. These values are summed up in order to return the final lighting value. </span><hr style="page-break-before:always;display:none;"></p><p class="c0"><span class="c6 c5">Hemisphere Sampled Dragon</span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 480.00px; height: 360.00px;"><img alt="" src="images/image46.png" style="width: 480.00px; height: 360.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c6 c5">Importance Sampled Dragon</span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 480.00px; height: 360.00px;"><img alt="" src="images/image7.png" style="width: 480.00px; height: 360.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><hr style="page-break-before:always;display:none;"></p><p class="c0"><span class="c5 c6">Hemisphere Sampled Bunny</span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 480.00px; height: 360.00px;"><img alt="" src="images/image45.png" style="width: 480.00px; height: 360.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c2">Importance Sampled Bunny</span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 480.00px; height: 360.00px;"><img alt="" src="images/image24.png" style="width: 480.00px; height: 360.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><hr style="page-break-before:always;display:none;"></p><p class="c0"><span class="c6 c5">Hemisphere Sampled Spheres</span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 480.00px; height: 360.00px;"><img alt="" src="images/image57.png" style="width: 480.00px; height: 360.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c6 c5">Importance Sampled Spheres</span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 480.00px; height: 360.00px;"><img alt="" src="images/image28.png" style="width: 480.00px; height: 360.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><hr style="page-break-before:always;display:none;"></p><p class="c8"><span class="c5">Using these images, we can see some clear differences between the two sampling methods. First, looking at the dragon render, we can see that under hemisphere sampling, it actually renders nothing whilst under importance sampling, it comes out perfect. This is because this implementation of hemisphere sampling actually cannot handle point lights, which shows us a big advantage of using importance sampling as it can handle them just fine. Looking at the sphere and bunny pictures, we can also see that hemisphere sampling is much noisier than importance sampling. The hemisphere sampling pictures have black dots spread across the whole of the image while the importance sampling pictures are very smooth everywhere. Despite these differences, both methods still show the lighting quite similarly, as if you ignore the noise from the hemisphere sampling pictures, the lighting looks very similar to the importance sampling pictures.</span><hr style="page-break-before:always;display:none;"></p><p class="c0"><span class="c2">Spheres with 1 Light Ray</span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 480.00px; height: 360.00px;"><img alt="" src="images/image29.png" style="width: 480.00px; height: 360.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c6 c5">Spheres with 4 Light Rays</span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 480.00px; height: 360.00px;"><img alt="" src="images/image47.png" style="width: 480.00px; height: 360.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><hr style="page-break-before:always;display:none;"></p><p class="c0"><span class="c6 c5">Spheres with 16 Light Rays</span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 480.00px; height: 360.00px;"><img alt="" src="images/image38.png" style="width: 480.00px; height: 360.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c6 c5">Spheres with 64 Light Rays</span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 480.00px; height: 360.00px;"><img alt="" src="images/image55.png" style="width: 480.00px; height: 360.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><hr style="page-break-before:always;display:none;"></p><p class="c8"><span class="c5">As the number of light rays increases, the noisiness of the lighting decreases. This makes sense since increasing the number of light rays increases the number of samples we take per light source in importance sampling. This reduces the random noise that we get from doing random sampling, leading to a less noisy image.</span><hr style="page-break-before:always;display:none;"></p><p class="c0"><span class="c10 c9">Part 4: Global Illumination</span></p><p class="c4"><span class="c1"></span></p><p class="c8"><span class="c5">For my indirect lighting function, I make it a recursive function with the base case being when the input ray is at a ray depth is equal to 1 (where the ray depth on the initial call to the function is set to the maximum ray depth). At the base case, it will just return the one bounce radiance with the given parameters (the process from part 3). Otherwise, it will add the one bounce radiance to the output of the function. Note that step if the base case is not true will not happen if we do not want to accumulate the colors of all bounces in the scene. A random direction is sampled away from the hit point in a way similar to direct hemisphere sampling and a ray is made in that direction with the origin being the hit point on the current object. This ray has its depth subtracted by 1. If this ray does not intersect anything, then just return the current output as there is no more light being reflected. Otherwise, use the reflectance equation with L_i being replaced with a recursive call to this same function with the new ray and its intersection point as input and with probability according to a probability density function defined by the bsdf which w_j was sampled from. Add this value to the output vector and return it. In order to add Russian Roulette, which randomly terminates at every recursive call with a chosen percentage (35%), a weighted coin flip is done before creating our random ray, returning the current value of the output vector. In order to correct our output because of needing this extra random event, we divide our reflectance by the chance that the Russian Roulette did not terminate.</span><hr style="page-break-before:always;display:none;"></p><p class="c0"><span class="c6 c5">Global Illumination Blob</span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 480.00px; height: 360.00px;"><img alt="" src="images/image19.png" style="width: 480.00px; height: 360.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span class="c2">&nbsp;</span></p><p class="c0"><span class="c2">Global Illumination Dragon</span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 480.00px; height: 360.00px;"><img alt="" src="images/image15.png" style="width: 480.00px; height: 360.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><hr style="page-break-before:always;display:none;"></p><p class="c0"><span class="c6 c5">Global Illumination Spheres</span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 480.00px; height: 360.00px;"><img alt="" src="images/image54.png" style="width: 480.00px; height: 360.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c6 c5">Global Illumination Bunny</span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 480.00px; height: 360.00px;"><img alt="" src="images/image14.png" style="width: 480.00px; height: 360.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><hr style="page-break-before:always;display:none;"></p><p class="c0"><span class="c6 c5">Bunny - Direct Illumination Only</span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 480.00px; height: 360.00px;"><img alt="" src="images/image21.png" style="width: 480.00px; height: 360.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c6 c5">Bunny - Indirect Illumination Only</span><span class="c1">&nbsp;</span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 480.00px; height: 360.00px;"><img alt="" src="images/image26.png" style="width: 480.00px; height: 360.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><hr style="page-break-before:always;display:none;"></p><p class="c8"><span class="c5">In the direct illumination bunny, you can see that all the shading is dark and does not really carry any other color. It tells us the general intensity of shading in the correct parts of the image where the indirect illumination will fill in without actually showing the nuance of the coloring from the walls. The indirect lighting has no pure black shading on the bunny, instead adding correct coloring to the bunny. So, when these two are combined, the areas where the lights are directly hitting the bunny stay the same color while the black areas which were not are filled in by the other bounces.</span><hr style="page-break-before:always;display:none;"></p><p class="c0"><span class="c6 c5">Bunny 0th Bounce</span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 480.00px; height: 360.00px;"><img alt="" src="images/image5.png" style="width: 480.00px; height: 360.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c6 c5">Bunny 1st Bounce</span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 480.00px; height: 360.00px;"><img alt="" src="images/image36.png" style="width: 480.00px; height: 360.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><hr style="page-break-before:always;display:none;"><p class="c0 c7"><span class="c1"></span></p><p class="c0"><span class="c6 c5">Bunny 2nd Bounce</span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 480.00px; height: 360.00px;"><img alt="" src="images/image31.png" style="width: 480.00px; height: 360.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c6 c5">Bunny 3rd Bounce</span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 480.00px; height: 360.00px;"><img alt="" src="images/image27.png" style="width: 480.00px; height: 360.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><hr style="page-break-before:always;display:none;"></p><p class="c0"><span class="c6 c5">Bunny 4th Bounce</span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 480.00px; height: 360.00px;"><img alt="" src="images/image8.png" style="width: 480.00px; height: 360.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c6 c5">Bunny 5th Bounce</span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 480.00px; height: 360.00px;"><img alt="" src="images/image18.png" style="width: 480.00px; height: 360.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><hr style="page-break-before:always;display:none;"></p><p class="c8"><span class="c5">In the 2nd bounce of light, you can see the effect of the colored walls on the bunny. In the second bounce, the light from the walls actually reaches the bunny since the light takes one bounce from the light at the top and then another bounce from the colored walls to the bunny. This bounce adds more color to the bunny, specifically red, white, and blue compared to bounce 1 which was just completely black in all its shading. The third bounce shows a similar effect, however it is much darker than bounce 2. This is because the energy from the light is dissipating after every bounce, which makes the effect of later bounces less dramatic than those of earlier bounces.</span><hr style="page-break-before:always;display:none;"></p><p class="c0"><span class="c6 c5">Bunny - 0 Bounces (Accumulated)</span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 480.00px; height: 360.00px;"><img alt="" src="images/image32.png" style="width: 480.00px; height: 360.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c6 c5">Bunny - 1 Bounce (Accumulated)</span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 480.00px; height: 360.00px;"><img alt="" src="images/image16.png" style="width: 480.00px; height: 360.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><hr style="page-break-before:always;display:none;"></p><p class="c0"><span class="c2">Bunny - 2 Bounces (Accumulated)</span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 480.00px; height: 360.00px;"><img alt="" src="images/image9.png" style="width: 480.00px; height: 360.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c6 c5">Bunny - 3 Bounces (Accumulated)</span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 480.00px; height: 360.00px;"><img alt="" src="images/image48.png" style="width: 480.00px; height: 360.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><hr style="page-break-before:always;display:none;"><p class="c0 c7"><span class="c1"></span></p><p class="c0"><span class="c6 c5">Bunny - 4 Bounces (Accumulated)</span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 480.00px; height: 360.00px;"><img alt="" src="images/image48.png" style="width: 480.00px; height: 360.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c6 c5">Bunny - 5 Bounces (Accumulated)</span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 480.00px; height: 360.00px;"><img alt="" src="images/image41.png" style="width: 480.00px; height: 360.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><hr style="page-break-before:always;display:none;"></p><p class="c8"><span class="c5">The 0th and 1st bounce are just the same as in direct illumination. After the 2nd bounce, we can see a great improvement as the previously dark shadows are given more color due to the bounces from the walls. The 3rd bounce gives a little bit more nuance to the coloring though it is very slight. The 4th and 5th bounce both do contribute but their effects are not very noticeable. This tells us that most of the information that we need is encapsulated in the first few bounces, which means that we can limit the number of bounces we use in a simple image such as this one in order to get an image of similar quality with much less compute.</span><hr style="page-break-before:always;display:none;"></p><p class="c0"><span class="c6 c5">Bunny - 0 Bounces (Accumulated) w/ Russian Roulette</span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 480.00px; height: 360.00px;"><img alt="" src="images/image20.png" style="width: 480.00px; height: 360.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c2">Bunny - 0 Bounce (Accumulated) w/ Russian Roulette</span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 480.00px; height: 360.00px;"><img alt="" src="images/image2.png" style="width: 480.00px; height: 360.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><hr style="page-break-before:always;display:none;"></p><p class="c0"><span class="c2">Bunny - 2 Bounces (Accumulated) w/ Russian Roulette</span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 480.00px; height: 360.00px;"><img alt="" src="images/image40.png" style="width: 480.00px; height: 360.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c2">Bunny - 3 Bounces (Accumulated) w/ Russian Roulette</span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 480.00px; height: 360.00px;"><img alt="" src="images/image39.png" style="width: 480.00px; height: 360.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><hr style="page-break-before:always;display:none;"></p><p class="c0"><span class="c2">Bunny - 4 Bounces (Accumulated) w/ Russian Roulette</span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 480.00px; height: 360.00px;"><img alt="" src="images/image56.png" style="width: 480.00px; height: 360.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c6 c5">Bunny - 100 Bounces (Accumulated) w/ Russian Roulette<br></span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 480.00px; height: 360.00px;"><img alt="" src="images/image10.png" style="width: 480.00px; height: 360.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><hr style="page-break-before:always;display:none;"></p><p class="c0"><span class="c6 c5">Spheres - Sample per Pixel Rate = 1</span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 480.00px; height: 360.00px;"><img alt="" src="images/image11.png" style="width: 480.00px; height: 360.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c2">Spheres - Sample per Pixel Rate = 2</span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 480.00px; height: 360.00px;"><img alt="" src="images/image34.png" style="width: 480.00px; height: 360.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><hr style="page-break-before:always;display:none;"></p><p class="c0"><span class="c2">Spheres - Sample per Pixel Rate = 4</span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 480.00px; height: 360.00px;"><img alt="" src="images/image37.png" style="width: 480.00px; height: 360.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c2">Spheres - Sample per Pixel Rate = 8</span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 480.00px; height: 360.00px;"><img alt="" src="images/image43.png" style="width: 480.00px; height: 360.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><hr style="page-break-before:always;display:none;"></p><p class="c0"><span class="c2">Spheres - Sample per Pixel Rate = 16</span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 480.00px; height: 360.00px;"><img alt="" src="images/image25.png" style="width: 480.00px; height: 360.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c2">Spheres - Sample per Pixel Rate = 64</span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 480.00px; height: 360.00px;"><img alt="" src="images/image30.png" style="width: 480.00px; height: 360.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><hr style="page-break-before:always;display:none;"><p class="c0 c7"><span class="c1"></span></p><p class="c0"><span class="c2">Spheres - Sample per Pixel Rate = 1024</span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 480.00px; height: 360.00px;"><img alt="" src="images/image35.png" style="width: 480.00px; height: 360.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c4"><span class="c1"></span></p><p class="c8"><span class="c5">Sample per pixel rate determines how many times each pixel in the image has rays sampled from it. We can see that as sample rate increases, the noisiness of the image decreases. We can see this by comparing when sample rate is 1 and when sample rate is 1024. When sample rate is 1, it still gets the shaded areas generally correct but will have bright white pixels spread around where it should be dark. This is because there&#39;s only one random sample, which leads to a lot of variance in output. Meanwhile, with a sample rate of 1024, a lot of random samples are being aggregated in order to give an accurate image with correct shading. It is also interesting to note that as sample rate increases, the gradient of how the shading changes becomes slower in transition.</span><hr style="page-break-before:always;display:none;"></p><p class="c0"><span class="c10 c9">Part 5: Adaptive Sampling</span></p><p class="c0 c7"><span class="c10 c11"></span></p><p class="c8"><span class="c1">Adaptive sampling essentially stops sampling light rays for a particular pixel once it converges as we can be confident about the output for this pixel. Specifically, it stops sampling once we have a value named I dependent on the standard deviation of our sample outputs and the number of samples taken is less than a small constant times the mean. Having an I value which is small means the standard deviation is low or there have been a lot of samples taken, which means that we can be confident about the current value. This prevents us from taking unnecessary samples and reduces runtime. </span></p><p class="c4"><span class="c1"></span></p><p class="c8"><span class="c1">In my implementation of adaptive sampling, I keep track of the mean and variance by keeping track of these two variables:</span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 255.00px; height: 228.00px;"><img alt="" src="images/image49.png" style="width: 255.00px; height: 228.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c8"><span class="c1">Where x_k is the illuminance of sample k. These can be used to calculate the mean and variance at any time by using these formulas: </span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 348.00px; height: 187.00px;"><img alt="" src="images/image1.png" style="width: 348.00px; height: 187.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c8"><span class="c1">I use these to check periodically whether or not the aforementioned convergence condition has been met. If it is met, then I stop sampling early. In order to not have to check that the pixel value has converged after every sample, I instead check it after going through an entire batch of samples (with batch size given as input). This reduces the amount of times I have to check and also leads to more meaningful checks as more will have changed in a whole batch of samples. </span></p><hr style="page-break-before:always;display:none;"><p class="c4"><span class="c1"></span></p><p class="c0"><span class="c2">Adaptive Sampled Bunny (Red = Many Samples, Blue = Few Samples)</span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 480.00px; height: 360.00px;"><img alt="" src="images/image13.png" style="width: 480.00px; height: 360.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 480.00px; height: 360.00px;"><img alt="" src="images/image6.png" style="width: 480.00px; height: 360.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><hr style="page-break-before:always;display:none;"></p><p class="c0"><span class="c6 c5">Adaptive Sampled Spheres (Red = Many Samples, Blue = Few Samples)</span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 480.00px; height: 360.00px;"><img alt="" src="images/image17.png" style="width: 480.00px; height: 360.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 480.00px; height: 360.00px;"><img alt="" src="images/image50.png" style="width: 480.00px; height: 360.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p></body></html>